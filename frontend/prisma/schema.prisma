generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model news {
  id             Int             @id @default(autoincrement())
  news_id        String          @unique(map: "ix_news_news_id") @db.VarChar
  news_url       String          @db.VarChar
  thum_url       String?         @db.VarChar
  broadcast_date DateTime        @db.Timestamp(6)
  category       String?         @db.VarChar
  created_date   DateTime?       @db.Timestamptz(6)
  comments       comment[]
  llm_translate  llm_translate[]
  news_english   news_english[]
  news_korean    news_korean[]
  tts            tts?

  @@index([id], map: "ix_news_id")
}

model news_english {
  id       Int    @id @default(autoincrement())
  news_id  String @db.VarChar
  language String @db.VarChar
  title    String
  content  String
  news     news   @relation(fields: [news_id], references: [news_id], onDelete: NoAction, onUpdate: NoAction)

  @@index([id], map: "ix_news_english_id")
  @@index([news_id], map: "ix_news_english_news_id")
}

model news_korean {
  id       Int    @id @default(autoincrement())
  news_id  String @db.VarChar
  language String @db.VarChar
  title    String
  content  String
  news     news   @relation(fields: [news_id], references: [news_id], onDelete: NoAction, onUpdate: NoAction)

  @@index([id], map: "ix_news_korean_id")
  @@index([news_id], map: "ix_news_korean_news_id")
}

model llm_translate {
  id      Int    @id @default(autoincrement())
  news_id String @db.VarChar
  english String
  korean  String
  news    news   @relation(fields: [news_id], references: [news_id], onDelete: NoAction, onUpdate: NoAction)

  @@index([id], map: "ix_llm_translate_id")
  @@index([news_id], map: "ix_llm_trnaslate_news_id")
}

model comment {
  id        Int       @id @default(autoincrement())
  news_id   String    @db.VarChar
  parentId  Int?
  content   String
  userId    Int?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt
  news      news      @relation(fields: [news_id], references: [news_id], onDelete: Cascade)
  parent    comment?  @relation("CommentToParent", fields: [parentId], references: [id], onDelete: Cascade)
  children  comment[] @relation("CommentToParent")
  user      user?     @relation(fields: [userId], references: [id])

  @@index([id], map: "ix_comment_id")
  @@index([news_id], map: "ix_comment_news_id")
  @@index([userId], map: "ix_comment_user_id")
}

model user {
  id             Int             @id @default(autoincrement())
  providerId     String          @db.VarChar
  email          String?         @unique
  name           String?
  profilePicture String?         @db.VarChar
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  board_comment  board_comment[]
  comments       comment[]
  o_auth_account o_auth_account?
  post           post[]
}

model board {
  id          Int      @id @default(autoincrement())
  name        String   @unique @db.VarChar
  code        String   @db.VarChar
  description String?  @db.VarChar
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  post        post[]
}

model tts {
  id                   Int     @id @default(autoincrement())
  news_id              String  @unique @db.VarChar
  full_text_audio_path String? @db.VarChar
  sentences_audio_path Json?   @db.Json
  news                 news    @relation(fields: [news_id], references: [news_id], onDelete: NoAction, onUpdate: NoAction)

  @@index([id], map: "ix_tts_id")
}

model board_comment {
  id                  Int             @id @default(autoincrement())
  postId              Int
  parentId            Int?
  content             String
  userId              Int?
  createdAt           DateTime        @default(now())
  updatedAt           DateTime
  board_comment       board_comment?  @relation("board_commentToboard_comment", fields: [parentId], references: [id], onDelete: Cascade)
  other_board_comment board_comment[] @relation("board_commentToboard_comment")
  post                post            @relation(fields: [postId], references: [id], onDelete: Cascade)
  user                user?           @relation(fields: [userId], references: [id])
}

model o_auth_account {
  id           Int      @id @default(autoincrement())
  provider     String
  providerId   String   @unique
  accessToken  String   @db.VarChar
  refreshToken String?  @db.VarChar
  expiresAt    DateTime
  scope        String?  @db.VarChar
  tokenType    String   @db.VarChar
  userId       Int?     @unique
  user         user?    @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model post {
  id            Int             @id @default(autoincrement())
  boardId       Int
  title         String          @db.VarChar
  content       String
  userId        Int?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime
  imageUrl      String?
  board_comment board_comment[]
  board         board           @relation(fields: [boardId], references: [id], onDelete: Cascade)
  user          user?           @relation(fields: [userId], references: [id])
}
